version: v1.0
name: Deploy to Staging
agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu1804
blocks:
  - name: Deploy - Staging
    task:
      secrets:
        - name: DuplicaWeb
      jobs:
        - name: Deploy to Staging in S3
          commands:
            - checkout
            - cache restore website-build
            - 'aws s3 sync "dist" "s3://$BUCKET_NAME_STG" --acl "public-read"'
promotions:
  - name: Deploy - Production
    pipeline_file: pipeline_4.yml
